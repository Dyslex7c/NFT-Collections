//SPDX-License-Identifier: MIT

pragma solidity ^0.8.18;

import {Test, console} from "forge-std/Test.sol";
import {MoodNFT} from "../../src/MoodNFT.sol";
import {DeployMoodNFT} from "../../script/DeployMoodNFT.s.sol";

contract MoodNftIntegrationTest is Test{
    MoodNFT moodNft;
    string public constant HAPPY_SVG_IMAGE_URI = "data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgd2lkdGg9IjQwMCIgaGVpZ2h0PSI0MDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogIDxkZWZzPg0KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JleUdyYWRpZW50IiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4NCiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOnJnYigyNTUsIDI1NSwgMjU1KTsgc3RvcC1vcGFjaXR5OjEiIC8+DQogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOnJnYigwLCAwLCAwKTsgc3RvcC1vcGFjaXR5OjEiIC8+DQogICAgPC9saW5lYXJHcmFkaWVudD4NCiAgPC9kZWZzPg0KICANCiAgPGNpcmNsZSBjeD0iMTAwIiBjeT0iMTAwIiByPSI4MCIgZmlsbD0idXJsKCNncmV5R3JhZGllbnQpIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utd2lkdGg9IjMiIC8+DQogIA0KICA8ZyBjbGFzcz0iZXllcyI+DQogICAgPHBhdGggZD0iTTU1IDc1IFEgNzAgNTUsIDg1IDc1IFQgNTUgNzUiIGZpbGw9IndoaXRlIiAvPg0KICAgIDxwYXRoIGQ9Ik0xMTUgNzUgUSAxMzAgNTUsIDE0NSA3NSBUIDExNSA3NSIgZmlsbD0id2hpdGUiIC8+DQogICAgPHBhdGggZD0iTTUwIDcwIFEgNzAgNDAsIDkwIDcwIiBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utd2lkdGg9IjQiLz4NCiAgICA8cGF0aCBkPSJNMTEwIDcwIFEgMTMwIDQwLCAxNTAgNzAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iNCIvPg0KICA8L2c+DQogIA0KICA8ZyBjbGFzcz0ibW91dGgiPg0KICAgIDxwYXRoIGQ9Ik02MCAxMzAgQSA0MCAzMCAwIDAgMCAxNDAgMTMwIiBmaWxsPSJibGFjayIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSI0IiAvPg0KICA8L2c+DQo8L3N2Zz4NCg==";

    string public constant SAD_SVG_IMAGE_URI = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEycHgiIGhlaWdodD0iNTEycHgiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQogIDxkZWZzPg0KICAgIDxyYWRpYWxHcmFkaWVudCBpZD0iZ3JhZDEiIGN4PSI1MCUiIGN5PSI1MCUiIHI9IjUwJSIgZng9IjUwJSIgZnk9IjUwJSI+DQogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjpyZ2IoMjU1LDI1NSwyNTUpO3N0b3Atb3BhY2l0eToxIiAvPg0KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjpyZ2IoMjA0LDIwNCwyMDQpO3N0b3Atb3BhY2l0eToxIiAvPg0KICAgIDwvcmFkaWFsR3JhZGllbnQ+DQogIDwvZGVmcz4NCg0KICA8ZmlsdGVyIGlkPSJzaGFkb3ciIHg9Ii01MCUiIHk9Ii01MCUiIHdpZHRoPSIyMDAlIiBoZWlnaHQ9IjIwMCUiPg0KICAgIDxmZUdhdXNzaWFuQmx1ciBpbj0iU291cmNlQWxwaGEiIHN0ZERldmlhdGlvbj0iMyIvPg0KICAgIDxmZU9mZnNldCBkeD0iNSIgZHk9IjUiIHJlc3VsdD0ib2Zmc2V0Ymx1ciIvPg0KICAgIDxmZUZsb29kIGZsb29kLWNvbG9yPSJyZ2JhKDAsMCwwLDAuMykiLz4NCiAgICA8ZmVDb21wb3NpdGUgaW4yPSJvZmZzZXRibHVyIiBvcGVyYXRvcj0iaW4iLz4NCiAgICA8ZmVNZXJnZT4NCiAgICAgIDxmZU1lcmdlTm9kZS8+DQogICAgICA8ZmVNZXJnZU5vZGUgaW49IlNvdXJjZUdyYXBoaWMiLz4NCiAgICA8L2ZlTWVyZ2U+DQogIDwvZmlsdGVyPg0KDQogIDxjaXJjbGUgY3g9IjUxMiIgY3k9IjUxMiIgcj0iNDQ4IiBmaWxsPSJ1cmwoI2dyYWQxKSIgc3Ryb2tlPSIjMzMzIiBzdHJva2Utd2lkdGg9IjEwIiBmaWx0ZXI9InVybCgjc2hhZG93KSIgLz4NCg0KICA8Y2lyY2xlIGN4PSI0MDAiIGN5PSI0MjAiIHI9IjQwIiBmaWxsPSIjMzMzIiAvPg0KICA8Y2lyY2xlIGN4PSI2MjAiIGN5PSI0MjAiIHI9IjQwIiBmaWxsPSIjMzMzIiAvPg0KDQogIDxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSIyNSIgZD0iTTM2MCA2NjAgUSA1MTIgNTcwLCA2NjAgNjYwIiAvPg0KDQogIDxjaXJjbGUgY3g9IjM4MCIgY3k9IjU3MCIgcj0iMjAiIGZpbGw9IiNFNkU2RTYiIG9wYWNpdHk9IjAuNSIgLz4NCiAgPGNpcmNsZSBjeD0iNjQwIiBjeT0iNTcwIiByPSIyMCIgZmlsbD0iI0U2RTZFNiIgb3BhY2l0eT0iMC41IiAvPg0KPC9zdmc+DQo=";
    
    string public constant SAD_SVG_URI = "data:application/json;base64,eyJuYW1lIjogIk1vb2QgTkZUIiwgImRlc2NyaXB0aW9uIjogIkFuIE5GVCB0aGF0IHJlZmxlY3RzIHRoZSBvd25lcnMgbW9vZC4iLCAiYXR0cmlidXRlcyI6IFt7InRyYWl0X3R5cGUiOiAibW9vZGluZXNzIiwgInZhbHVlIjogMTAwfV0sICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEV5Y0hnaUlHaGxhV2RvZEQwaU5URXljSGdpSUhacFpYZENiM2c5SWpBZ01DQXhNREkwSURFd01qUWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SStEUW9nSUR4a1pXWnpQZzBLSUNBZ0lEeHlZV1JwWVd4SGNtRmthV1Z1ZENCcFpEMGlaM0poWkRFaUlHTjRQU0kxTUNVaUlHTjVQU0kxTUNVaUlISTlJalV3SlNJZ1puZzlJalV3SlNJZ1puazlJalV3SlNJK0RRb2dJQ0FnSUNBOGMzUnZjQ0J2Wm1aelpYUTlJakFsSWlCemRIbHNaVDBpYzNSdmNDMWpiMnh2Y2pweVoySW9NalUxTERJMU5Td3lOVFVwTzNOMGIzQXRiM0JoWTJsMGVUb3hJaUF2UGcwS0lDQWdJQ0FnUEhOMGIzQWdiMlptYzJWMFBTSXhNREFsSWlCemRIbHNaVDBpYzNSdmNDMWpiMnh2Y2pweVoySW9NakEwTERJd05Dd3lNRFFwTzNOMGIzQXRiM0JoWTJsMGVUb3hJaUF2UGcwS0lDQWdJRHd2Y21Ga2FXRnNSM0poWkdsbGJuUStEUW9nSUR3dlpHVm1jejROQ2cwS0lDQThabWxzZEdWeUlHbGtQU0p6YUdGa2IzY2lJSGc5SWkwMU1DVWlJSGs5SWkwMU1DVWlJSGRwWkhSb1BTSXlNREFsSWlCb1pXbG5hSFE5SWpJd01DVWlQZzBLSUNBZ0lEeG1aVWRoZFhOemFXRnVRbXgxY2lCcGJqMGlVMjkxY21ObFFXeHdhR0VpSUhOMFpFUmxkbWxoZEdsdmJqMGlNeUl2UGcwS0lDQWdJRHhtWlU5bVpuTmxkQ0JrZUQwaU5TSWdaSGs5SWpVaUlISmxjM1ZzZEQwaWIyWm1jMlYwWW14MWNpSXZQZzBLSUNBZ0lEeG1aVVpzYjI5a0lHWnNiMjlrTFdOdmJHOXlQU0p5WjJKaEtEQXNNQ3d3TERBdU15a2lMejROQ2lBZ0lDQThabVZEYjIxd2IzTnBkR1VnYVc0eVBTSnZabVp6WlhSaWJIVnlJaUJ2Y0dWeVlYUnZjajBpYVc0aUx6NE5DaUFnSUNBOFptVk5aWEpuWlQ0TkNpQWdJQ0FnSUR4bVpVMWxjbWRsVG05a1pTOCtEUW9nSUNBZ0lDQThabVZOWlhKblpVNXZaR1VnYVc0OUlsTnZkWEpqWlVkeVlYQm9hV01pTHo0TkNpQWdJQ0E4TDJabFRXVnlaMlUrRFFvZ0lEd3ZabWxzZEdWeVBnMEtEUW9nSUR4amFYSmpiR1VnWTNnOUlqVXhNaUlnWTNrOUlqVXhNaUlnY2owaU5EUTRJaUJtYVd4c1BTSjFjbXdvSTJkeVlXUXhLU0lnYzNSeWIydGxQU0lqTXpNeklpQnpkSEp2YTJVdGQybGtkR2c5SWpFd0lpQm1hV3gwWlhJOUluVnliQ2dqYzJoaFpHOTNLU0lnTHo0TkNnMEtJQ0E4WTJseVkyeGxJR040UFNJME1EQWlJR041UFNJME1qQWlJSEk5SWpRd0lpQm1hV3hzUFNJak16TXpJaUF2UGcwS0lDQThZMmx5WTJ4bElHTjRQU0kyTWpBaUlHTjVQU0kwTWpBaUlISTlJalF3SWlCbWFXeHNQU0lqTXpNeklpQXZQZzBLRFFvZ0lEeHdZWFJvSUdacGJHdzlJbTV2Ym1VaUlITjBjbTlyWlQwaUl6TXpNeUlnYzNSeWIydGxMWGRwWkhSb1BTSXlOU0lnWkQwaVRUTTJNQ0EyTmpBZ1VTQTFNVElnTlRjd0xDQTJOakFnTmpZd0lpQXZQZzBLRFFvZ0lEeGphWEpqYkdVZ1kzZzlJak00TUNJZ1kzazlJalUzTUNJZ2NqMGlNakFpSUdacGJHdzlJaU5GTmtVMlJUWWlJRzl3WVdOcGRIazlJakF1TlNJZ0x6NE5DaUFnUEdOcGNtTnNaU0JqZUQwaU5qUXdJaUJqZVQwaU5UY3dJaUJ5UFNJeU1DSWdabWxzYkQwaUkwVTJSVFpGTmlJZ2IzQmhZMmwwZVQwaU1DNDFJaUF2UGcwS1BDOXpkbWMrRFFvPSJ9";

    DeployMoodNFT deployer;

    address USER = makeAddr("user");

    function setUp() public {
        deployer = new DeployMoodNFT();
        moodNft = deployer.run();
    }

    function testViewTokenURIIntegation() public {
        vm.prank(USER);
        moodNft.mintNFT();
        console.log(moodNft.tokenURI(0));
    }

    function testFlipTokenToSad() public {
        vm.prank(USER);
        moodNft.mintNFT();

        vm.prank(USER);
        moodNft.flipMood(0);

        assertEq(keccak256(abi.encodePacked(moodNft.tokenURI(0))), keccak256(abi.encodePacked(SAD_SVG_URI)));
        console.log(moodNft.tokenURI(0));
    }
}